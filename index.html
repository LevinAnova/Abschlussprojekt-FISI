<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Volkswagen Ausbildungsberufe</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="animated-background"></div>
  <div class="container">
    <header>
      <img src="img/vwlogo.png" alt="VW Logo" class="logo">
      <h1 class="title">Ausbildungsberufe</h1>
      <div style="width: 60px;"></div> <!-- Spacer to balance the header -->
    </header>
    
    <div class="filter-container" id="filterContainer">
      <!-- Filter buttons will be dynamically loaded -->
      <button class="filter-btn active" data-category="all">Alle</button>
    </div>
    
    <div class="card-container" id="cardContainer">
      <!-- Loading indicator -->
      <div id="loadingIndicator" class="loading-indicator">
        <div class="spinner"></div>
        <p>Daten werden geladen...</p>
      </div>
      <!-- Cards will be dynamically loaded -->
    </div>
    
    <footer>
      <p>© Volkswagen AG 2025 | Ausbildungsberufe</p>
    </footer>
  </div>
  
  <!-- Detail page template -->
  <div id="detailPage" class="detail-page">
    <div class="detail-header">
      <button id="backButton" class="back-button">←</button>
      <h2 id="detailTitle" class="detail-title">Ausbildungsberuf</h2>
      <div style="width: 40px;"></div>
    </div>
    
    <span id="detailCategory" class="detail-category">Kategorie</span>
    
    <div class="detail-section">
      <h3>Beschreibung</h3>
      <div id="detailDescription"></div>
    </div>
    
    <div class="detail-section">
      <h3>Ausbildungsdauer</h3>
      <div id="detailDuration"></div>
    </div>
    
    <div class="detail-section">
      <h3>Anforderungen</h3>
      <div id="detailRequirements"></div>
    </div>
    
    <div class="detail-section">
      <h3>Karrieremöglichkeiten</h3>
      <div id="detailCareer"></div>
    </div>
    
    <div class="detail-section">
      <h3>Standorte</h3>
      <div id="detailLocations"></div>
    </div>
  </div>

  <script>
    // Configuration object for CMS settings
    const cmsConfig = {
      // Adjust these settings based on your CMS
      apiUrl: 'api/content', // Path to your API endpoint
      imageBasePath: 'images/', // Base path for CMS images
      refreshInterval: 3600000, // Auto-refresh data every hour (in milliseconds)
      cacheName: 'vw-ausbildung-cache', // Cache name for offline functionality
      useMockData: true // Set to false in production, using mock data for development
    };
    
    // Cache for storing fetched data
    let contentCache = {
      categories: [],
      berufe: []
    };
    
    // Mock data for development (simulating CMS content)
    const mockData = {
      categories: [
        { id: "all", name: "Alle" },
        { id: "technik", name: "Technik" },
        { id: "elektronik", name: "Elektronik" },
        { id: "it", name: "IT" },
        { id: "kaufmannisch", name: "Kaufmännisch" },
        { id: "logistik", name: "Logistik" }
      ],
      
      berufe: [
        {
          id: "kfz-mechatroniker",
          title: "Kfz-Mechatroniker/in",
          description: "Wartung, Reparatur und Diagnose von Fahrzeugen",
          duration: "3,5 Jahre",
          category: "technik",
          requirements: ["Gutes technisches Verständnis", "Handwerkliches Geschick", "Interesse an Elektronik"],
          career_options: ["Meister/in für Kraftfahrzeugtechnik", "Techniker/in für Kraftfahrzeugtechnik", "Studium Fahrzeugtechnik"],
          locations: ["Wolfsburg", "Hannover", "Braunschweig"]
        },
        {
          id: "elektroniker-automatisierung",
          title: "Elektroniker/in für Automatisierungstechnik",
          description: "Installation und Programmierung von Automatisierungssystemen",
          duration: "3,5 Jahre",
          category: "elektronik",
          requirements: ["Interesse an Elektronik", "Technisches Verständnis", "Logisches Denkvermögen"],
          career_options: ["Techniker/in für Automatisierungstechnik", "Studium Elektrotechnik"],
          locations: ["Wolfsburg", "Kassel", "Emden"]
        },
        {
          id: "industriemechaniker",
          title: "Industriemechaniker/in",
          description: "Herstellung und Instandhaltung von Maschinen und Produktionsanlagen",
          duration: "3,5 Jahre",
          category: "technik",
          requirements: ["Handwerkliches Geschick", "Sorgfältige Arbeitsweise", "Technisches Verständnis"],
          career_options: ["Techniker/in für Maschinenbau", "Meister/in für Industriemechanik"],
          locations: ["Wolfsburg", "Hannover", "Emden", "Salzgitter"]
        },
        {
          id: "fachinformatiker-systemintegration",
          title: "Fachinformatiker/in für Systemintegration",
          description: "Planung und Konfiguration von IT-Systemen",
          duration: "3 Jahre",
          category: "it",
          requirements: ["Interesse an IT", "Logisches Denkvermögen", "Gute Englischkenntnisse"],
          career_options: ["IT-Systemadministrator/in", "IT-Projektmanager/in", "Studium Informatik"],
          locations: ["Emden"]
        },
        {
          id: "fachinformatiker-anwendungsentwicklung",
          title: "Fachinformatiker/in für Anwendungsentwicklung",
          description: "Entwicklung und Programmierung von Anwendungen",
          duration: "3 Jahre",
          category: "it",
          requirements: ["Programmierkenntnisse", "Logisches Denkvermögen", "Gute Englischkenntnisse"],
          career_options: ["Softwareentwickler/in", "Studium Informatik", "Web-Entwickler/in"],
          locations: ["Wolfsburg", "Berlin", "München"]
        },
        {
          id: "industriekaufmann",
          title: "Industriekaufmann/-frau",
          description: "Kaufmännische und betriebswirtschaftliche Tätigkeiten",
          duration: "3 Jahre",
          category: "kaufmannisch",
          requirements: ["Gute Kommunikationsfähigkeit", "Organisationsfähigkeit", "Wirtschaftliches Denken"],
          career_options: ["Betriebswirt/in", "Studium BWL", "Fachwirt/in für Industrie"],
          locations: ["Wolfsburg", "Hannover", "Stuttgart"]
        },
        {
          id: "technischer-produktdesigner",
          title: "Technische/r Produktdesigner/in",
          description: "Entwicklung technischer Produkte und Komponenten",
          duration: "3,5 Jahre",
          category: "technik",
          requirements: ["Räumliches Vorstellungsvermögen", "Technisches Zeichnen", "CAD-Kenntnisse"],
          career_options: ["Techniker/in für Konstruktion", "Studium Produktdesign"],
          locations: ["Wolfsburg", "Osnabrück"]
        },
        {
          id: "elektroniker-betriebstechnik",
          title: "Elektroniker/in für Betriebstechnik",
          description: "Installation und Wartung elektrischer Anlagen",
          duration: "3,5 Jahre",
          category: "elektronik",
          requirements: ["Handwerkliches Geschick", "Technisches Verständnis", "Mathematisches Grundwissen"],
          career_options: ["Techniker/in für Elektrotechnik", "Meister/in für Elektrotechnik"],
          locations: ["Wolfsburg", "Kassel", "Hannover"]
        },
        {
          id: "werkzeugmechaniker",
          title: "Werkzeugmechaniker/in",
          description: "Herstellung von Werkzeugen und Vorrichtungen",
          duration: "3,5 Jahre",
          category: "technik",
          requirements: ["Präzises Arbeiten", "Handwerkliches Geschick", "Technisches Verständnis"],
          career_options: ["Techniker/in für Werkzeugbau", "Meister/in für Werkzeugbau"],
          locations: ["Wolfsburg", "Braunschweig"]
        },
        {
          id: "fachkraft-lagerlogistik",
          title: "Fachkraft für Lagerlogistik",
          description: "Organisation und Verwaltung des Warenflusses",
          duration: "3 Jahre",
          category: "logistik",
          requirements: ["Organisationsfähigkeit", "Sorgfältige Arbeitsweise", "Technisches Verständnis"],
          career_options: ["Logistikmeister/in", "Fachwirt/in für Logistik"],
          locations: ["Wolfsburg", "Hannover", "Kassel"]
        }
      ]
    };
    
    // Fetch data from CMS API or use mock data
    async function fetchCmsData() {
      const loadingIndicator = document.getElementById('loadingIndicator');
      loadingIndicator.style.display = 'flex';
      
      try {
        if (cmsConfig.useMockData) {
          // Simulate API delay
          await new Promise(resolve => setTimeout(resolve, 1000));
          return mockData;
        } else {
          // Real API fetch
          const response = await fetch(cmsConfig.apiUrl);
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return await response.json();
        }
      } catch (error) {
        console.error('Error fetching data:', error);
        // Show error message to user
        const cardContainer = document.getElementById('cardContainer');
        cardContainer.innerHTML = `
          <div class="error-message">
            <p>Fehler beim Laden der Daten. Bitte versuchen Sie es später erneut.</p>
            <button id="retryButton">Erneut versuchen</button>
          </div>
        `;
        document.getElementById('retryButton').addEventListener('click', initializeApp);
        return null;
      } finally {
        loadingIndicator.style.display = 'none';
      }
    }
    
    // Initialize filter buttons from categories
    function initializeFilters(categories) {
      const filterContainer = document.getElementById('filterContainer');
      filterContainer.innerHTML = '';
      
      categories.forEach(category => {
        const button = document.createElement('button');
        button.className = 'filter-btn' + (category.id === 'all' ? ' active' : '');
        button.setAttribute('data-category', category.id);
        button.textContent = category.name;
        
        button.addEventListener('click', function() {
          // Add visual feedback for touch
          this.classList.add('touch-active');
          setTimeout(() => {
            this.classList.remove('touch-active');
          }, 200);
          
          // Remove active class from all buttons
          document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.classList.remove('active');
          });
          
          // Add active class to clicked/touched button
          this.classList.add('active');
          
          // Filter the cards
          filterCards(this.dataset.category);
        });
        
        filterContainer.appendChild(button);
      });
    }
    
    // Create cards from berufe data
    function createCards(berufe) {
      const container = document.getElementById('cardContainer');
      container.innerHTML = '';
      
      berufe.forEach((beruf, index) => {
        const card = document.createElement('div');
        card.className = 'card';
        card.dataset.id = beruf.id;
        card.dataset.category = beruf.category;
        card.style.animationDelay = `${0.1 + (index * 0.05)}s`;
        
        // Add click event to open detail page
        card.addEventListener('click', function() {
          openDetailPage(beruf.id);
        });
        
        card.innerHTML = `
          <div class="card-header">
            <h2 class="card-title">${beruf.title}</h2>
            <div class="card-category">${getCategoryName(beruf.category)}</div>
          </div>
          <div class="card-body">
            <p class="card-description">${beruf.description}</p>
            <div class="card-duration">Ausbildungsdauer: ${beruf.duration}</div>
          </div>
        `;
        
        container.appendChild(card);
      });
    }
    
    // Helper function to get category name by id
    function getCategoryName(categoryId) {
      const category = contentCache.categories.find(cat => cat.id === categoryId);
      return category ? category.name : categoryId;
    }
    
    // Find beruf by ID
    function findBerufById(id) {
      return contentCache.berufe.find(beruf => beruf.id === id);
    }
    
    // Filter cards by category
    function filterCards(categoryId) {
      const cards = document.querySelectorAll('.card');
      
      cards.forEach((card, index) => {
        const display = categoryId === 'all' || card.dataset.category === categoryId;
        
        // Reset animation first
        card.style.animation = 'none';
        
        if (display) {
          card.style.display = 'flex';
          // Re-trigger animation with a slight delay for staggered effect
          setTimeout(() => {
            card.style.animation = `rotateIn 0.7s cubic-bezier(0.23, 1, 0.32, 1) forwards ${index * 0.05}s`;
          }, 10);
        } else {
          card.style.display = 'none';
        }
      });
    }
    
    // Open detail page for beruf by ID
    function openDetailPage(berufId) {
      const detailPage = document.getElementById('detailPage');
      const beruf = findBerufById(berufId);
      
      if (!beruf) {
        console.error(`Beruf with ID ${berufId} not found`);
        return;
      }
      
      const detailTitle = document.getElementById('detailTitle');
      const detailCategory = document.getElementById('detailCategory');
      const detailDescription = document.getElementById('detailDescription');
      const detailDuration = document.getElementById('detailDuration');
      const detailRequirements = document.getElementById('detailRequirements');
      const detailCareer = document.getElementById('detailCareer');
      const detailLocations = document.getElementById('detailLocations');
      
      // Set content
      detailTitle.textContent = beruf.title;
      detailCategory.textContent = getCategoryName(beruf.category);
      detailDescription.innerHTML = `<p>${beruf.description}</p>`;
      detailDuration.innerHTML = `<p>${beruf.duration}</p>`;
      
      // Set requirements if available
      if (beruf.requirements && beruf.requirements.length > 0) {
        detailRequirements.innerHTML = `<ul>${beruf.requirements.map(req => `<li>${req}</li>`).join('')}</ul>`;
      } else {
        detailRequirements.innerHTML = '<p>Keine Angaben</p>';
      }
      
      // Set career options if available
      if (beruf.career_options && beruf.career_options.length > 0) {
        detailCareer.innerHTML = `<ul>${beruf.career_options.map(career => `<li>${career}</li>`).join('')}</ul>`;
      } else {
        detailCareer.innerHTML = '<p>Keine Angaben</p>';
      }
      
      // Set locations if available
      if (beruf.locations && beruf.locations.length > 0) {
        detailLocations.innerHTML = `<ul>${beruf.locations.map(location => `<li>${location}</li>`).join('')}</ul>`;
      } else {
        detailLocations.innerHTML = '<p>Keine Angaben</p>';
      }
      
      // Apply animations for text sections
      const detailSections = document.querySelectorAll('.detail-section');
      detailSections.forEach((section, index) => {
        section.style.animationDelay = `${0.3 + (index * 0.1)}s`;
      });
      
      // Show detail page with animation
      detailPage.style.display = 'flex';
      document.body.style.overflow = 'hidden'; // Prevent scrolling background
      
      // Reset animation
      detailPage.style.animation = 'none';
      setTimeout(() => {
        detailPage.style.animation = 'slideIn 0.5s ease forwards';
      }, 10);
    }
    
    // Close detail page
    function closeDetailPage() {
      const detailPage = document.getElementById('detailPage');
      detailPage.style.animation = 'slideOut 0.5s ease forwards';
      
      // Hide detail page after animation completes
      setTimeout(() => {
        detailPage.style.display = 'none';
        document.body.style.overflow = 'auto'; // Re-enable scrolling
      }, 500);
    }
    
    // Initialize the app
    async function initializeApp() {
      // Fetch data from CMS
      const data = await fetchCmsData();
      
      if (data) {
        // Store data in cache
        contentCache = data;
        
        // Initialize filters
        initializeFilters(data.categories);
        
        // Create cards
        createCards(data.berufe);
      }
    }
    
    // Setup touch events for cards
    function setupTouchEvents() {
      document.addEventListener('click', function(event) {
        if (event.target.closest('#backButton')) {
          closeDetailPage();
        }
      });
      
      // Close detail page when pressing Escape key
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          closeDetailPage();
        }
      });
    }
    
    // Handle orientation changes
    function setupOrientationHandling() {
      // Detect orientation changes for Samsung Flip Display
      window.addEventListener('orientationchange', function() {
        // Re-layout the cards when orientation changes
        setTimeout(() => {
          const activeCategory = document.querySelector('.filter-btn.active').dataset.category;
          filterCards(activeCategory);
        }, 100);
      });
      
      // Check for orientation on resize too (for Flip Display)
      window.addEventListener('resize', function() {
        // Adjust layout based on orientation
        const isLandscape = window.innerWidth > window.innerHeight;
        document.body.classList.toggle('landscape', isLandscape);
        document.body.classList.toggle('portrait', !isLandscape);
      });
      
      // Set initial orientation
      const isLandscape = window.innerWidth > window.innerHeight;
      document.body.classList.toggle('landscape', isLandscape);
      document.body.classList.toggle('portrait', !isLandscape);
    }
    
    // Set up automatic refresh of content
    function setupAutoRefresh() {
      // Refresh content periodically
      if (cmsConfig.refreshInterval > 0) {
        setInterval(async function() {
          const data = await fetchCmsData();
          if (data) {
            contentCache = data;
            // Only update UI if user is not in detail view
            if (document.getElementById('detailPage').style.display !== 'flex') {
              const activeCategory = document.querySelector('.filter-btn.active').dataset.category;
              initializeFilters(data.categories);
              createCards(data.berufe);
              filterCards(activeCategory);
            }
          }
        }, cmsConfig.refreshInterval);
      }
    }
    
    // Initialize the page
    document.addEventListener('DOMContentLoaded', () => {
      initializeApp();
      setupTouchEvents();
      setupOrientationHandling();
      setupAutoRefresh();
    });
  </script>
</body>
</html>